<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Members — FormFactor Racing</title>
  <style>
    :root { --bg:#0b0f1a; --card:#12182a; --txt:#e8eef5; --muted:#9cb3c9; --brand:#00b4ff; --border:#243044; }
    body { margin:0; background:var(--bg); color:var(--txt); font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; }
    .container { max-width: 900px; margin: 0 auto; padding: 18px; }
    .site-header { position: sticky; top:0; background: rgba(11,15,26,.9); backdrop-filter: blur(6px); border-bottom:1px solid var(--border); }
    .row { display:flex; align-items:center; justify-content:space-between; gap:12px; }
    .brand { display:flex; align-items:center; gap:10px; color:var(--txt); text-decoration:none; font-weight:700; }
    .nav a { color:var(--muted); text-decoration:none; margin-left:14px; }
    .banner { margin:16px 0; background:linear-gradient(90deg,#34d399,#22d3ee); color:#042131; font-weight:700; border-radius:14px; padding:12px 14px; text-align:center; }
    .card { background:var(--card); border:1px solid var(--border); border-radius:14px; }
    .pad { padding:16px; }
    .tiny { font-size:12px; color:#9cb3c9; }
    .list { padding-left:18px; }
    .hidden { display:none; }
    .error { color:#fecaca; background:#7f1d1d33; border:1px solid #7f1d1d; padding:10px 12px; border-radius:10px; display:none }
    @media (max-width: 640px) { .nav { display:none; } }
  </style>
  <script>
    (function gate() {
      const VALID = ['FFR-DAY','FFR-WEEKEND','FFR-MONTHLY'];
      const qs = new URLSearchParams(location.search);
      const code = (qs.get('code') || (location.hash||'').replace('#','') || localStorage.getItem('FFR_ACCESS') || '').toUpperCase();
      if (!VALID.includes(code)) {{ window.__FFR_GATE_CODE__ = ''; }}
      else {{ localStorage.setItem('FFR_ACCESS', code); window.__FFR_GATE_CODE__ = code; }}
    })();
  </script>
</head>
<body>
  <header class="site-header">
    <div class="container row">
      <a class="brand" href="/"><span>FormFactor Racing</span></a>
      <nav class="nav"><a href="/">Home</a><a href="/terms.html">Terms</a></nav>
    </div>
  </header>

  <main class="container" style="padding:20px 0 36px">
    <div class="banner">Cox Plate Day — Saturday, 25 October 2025</div>

    <section id="gate" class="card pad hidden">
      <h2 style="margin:8px 0 6px">Enter your access code</h2>
      <div>
        <input id="code" style="width:100%;padding:12px 14px;border-radius:10px;border:1px solid #243044;background:#0f1625;color:#e8eef5" placeholder="e.g. FFR-DAY" autocomplete="one-time-code" autocapitalize="characters" />
        <div class="row" style="gap:10px; justify-content:flex-start;margin-top:10px">
          <button id="unlock" style="padding:10px 14px;border-radius:10px;background:#00b4ff;color:#02121f;border:none;font-weight:700" type="button">Unlock</button>
          <button id="clear" style="padding:10px 14px;border-radius:10px;background:#172033;color:#e8eef5;border:1px solid #243044" type="button">Clear</button>
        </div>
        <div id="msgErr" class="error">That code didn’t work. Check your purchase email/receipt and try again.</div>
      </div>
      <p class="tiny" style="margin-top:8px">Codes: <code>FFR-DAY</code>, <code>FFR-WEEKEND</code>, <code>FFR-MONTHLY</code></p>
    </section>

    <section id="board" class="card pad hidden">
      <div id="content"><p class="tiny">Loading…</p></div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
      <p>© <span id="y"></span> FormFactor Racing</p>
      <p class="tiny">All selections are general information only. Gamble responsibly — 1800 858 858 — gamblinghelponline.org.au</p>
    </div>
  </footer>

  <script>
    (function(){ var y=document.getElementById('y'); if(y) y.textContent=new Date().getFullYear(); })();
    const elGate=document.getElementById('gate'), elBoard=document.getElementById('board'), elCode=document.getElementById('code');
    const elUnlock=document.getElementById('unlock'), elClear=document.getElementById('clear'), elErr=document.getElementById('msgErr'), elContent=document.getElementById('content');
    const PICKS_PATH='/picks.json?v='+Date.now();
    function show(el){{el.classList.remove('hidden')}} function hide(el){{el.classList.add('hidden')}} function norm(s){{return (s||'').trim().toUpperCase()}} function valid(code){{return ['FFR-DAY','FFR-WEEKEND','FFR-MONTHLY'].includes(norm(code))}}
    function boot(){{ if (window.__FFR_GATE_CODE__) loadBoard(); else show(elGate); }}
    async function unlock(){{ const c=norm(elCode.value); if(!valid(c)){{elErr.style.display='block';return}} localStorage.setItem('FFR_ACCESS',c); elErr.style.display='none'; hide(elGate); loadBoard(); }}
    function clearCode(){{ localStorage.removeItem('FFR_ACCESS'); show(elGate); hide(elBoard); elCode.value=''; elCode.focus(); }}
    async function loadBoard(){{ show(elBoard); elContent.innerHTML='<p class="tiny">Loading today’s tips…</p>'; try{{ const res=await fetch(PICKS_PATH, {{cache:'no-store'}}); if(!res.ok) throw new Error('picks.json not found'); const data=await res.json(); renderBoard(data);}}
    catch(e){{ elContent.innerHTML='<p class="tiny">Tips not published yet.</p>'; }} }}
    function renderBoard(data){{ const parts=[]; parts.push('<h2 style="margin:0 0 6px 0">'+(data.headline||'Today’s selections')+'</h2>'); if(data.date) parts.push('<p class="tiny">Date: '+data.date+'</p>'); if(data.notes) parts.push('<p class="tiny">'+data.notes+'</p>');
      if(Array.isArray(data.featured)&&data.featured.length){{ parts.push('<div class="card pad" style="margin:10px 0;"><h3 style="margin:0 0 6px">Featured selections</h3><ul class="list">');
        data.featured.forEach(f=>{{ const horse=(f.horse&&String(f.horse).trim())?f.horse:'Name pending'; const conf=Number(f.confidence||0); const confLabel=conf>5?`${{conf}}/10`:`${{conf||3}}/5`; const track=f.track||'Track'; const race=f.race||'?'; const reason=f.reason||'';
        parts.push(`<li><strong>${{track}} — R${{race}}</strong>: ${{horse}} <span class="tiny">(${{confLabel}})</span><br><span class="tiny">${{reason}}</span></li>`); }}); parts.push('</ul></div>'); }}
      (data.meetings||[]).forEach(m=>{{ const state=(m.state&&String(m.state).trim())?` (${{m.state}})`:''; const trackTitle=(m.track||'Track')+state; parts.push('<h3 style="margin:12px 0 6px 0">'+trackTitle+'</h3><ul class="list">');
        (m.races||[]).forEach(r=>{{ const name=(r.top_pick&&String(r.top_pick).trim())?r.top_pick:'Name pending'; const c=Number(r.confidence||0); const label=c>5?`${{c}}/10`:`${{c||3}}/5`; const reason=r.reason||'';
          parts.push(`<li><strong>R${{r.number}}</strong>: ${{name}} <span class="tiny">(${{label}})</span><br><span class="tiny">${{reason}}</span></li>`); }});
        parts.push('</ul>'); }});
      elContent.innerHTML = parts.join('') || '<p>No selections posted yet.</p>'; window.scrollTo({{top:0, behavior:'smooth'}}); }}
    if (elUnlock) elUnlock.addEventListener('click', unlock);
    if (elClear) elClear.addEventListener('click', clearCode);
    if (elCode) elCode.addEventListener('keydown', (e)=>{{ if(e.key==='Enter') unlock(); }});
    boot();
  </script>
</body>
</html>
